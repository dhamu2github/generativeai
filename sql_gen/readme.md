# SQL Query Generator

A Python application that generates MySQL-compatible SQL queries from natural language text using the Groq LLM API. The application connects to a MySQL database, retrieves the schema information, and generates appropriate SQL queries based on user prompts.

## Features

- Natural language to SQL query conversion
- Automatic database schema retrieval
- Secure MySQL database connection handling
- Integration with Groq's LLM API
- Query execution capabilities

## Prerequisites

- Python 3.7+
- MySQL Server
- Groq API access
- Your MySQL database loaded with tables and data

## Installation

1. Clone the repository:
```bash
git clone https://github.com/dhamu2github/generativeai.git
cd sql_gen
```

2. Install required dependencies:
```bash
pip install mysql-connector-python groq
```

3. Set up environment variables:
```bash
export GROQ_API_KEY='your_groq_api_key_here'
```

## Configuration

Update the database configuration in `database_utils.py`:

```python
# MySQL connection details
db_config = {
    'host': 'localhost',       # Change if not on localhost
    'user': 'foodmart',         # Replace with your MySQL username
    'password': 'foodmart@123', # Replace with your MySQL password
    'database': 'FOODMART'      # Replace with your MySQL database name
}
```

## Project Structure

```
sql-query-generator/
├── sql_gen_app.py        # Main application entry point
├── model_utils.py        # LLM integration and query generation
└── database_utils.py     # Database connection and operations
```

### File Descriptions

- **sql_gen_app.py**: Main application script that orchestrates the connection to MySQL, schema retrieval, and query generation
- **model_utils.py**: Handles interaction with the Groq API and SQL query generation
- **database_utils.py**: Contains utilities for MySQL database operations

## Usage

1. Ensure your MySQL server is running and accessible with the configured credentials.

2. Run the application:
```bash
python sql_gen_app.py
```

## How it Works
1. **Connect to MySQL Database**: The app connects to your MySQL database using the credentials provided in database_utils.py.
2. **Fetch Database Schema**: It fetches schema details of the database (list of tables and their columns).
3. **Generate SQL Query**: The schema information and a text prompt (like "List top 5 products from the product table") are sent to the Groq API to generate a MySQL-compatible SQL query.
4. **Execute SQL Query**: The generated SQL query is executed on the connected MySQL database, and the results are printed to the console.

## Example

```python
# Example text prompt
text_prompt = "List top 5 products from the product table and join with table inventory_fact_1998 and get warehouse sales"
Important Notes: 
 1. Make this changes in the file 'sql_gen_app.py'
 2. You will get better result if you specify your table name with your correct requirement.
 

# Generated SQL query will be displayed in the console
```

## Files Description

#### `sql_gen_app.py`

This is the main application script that ties everything together. It:

1. Connects to the MySQL database.
2. Fetches the database schema.
3. Accepts a text prompt and generates the corresponding SQL query using a machine learning model.
4. Executes the generated SQL query.
5. Closes the MySQL connection.

#### `model_utils.py`

This file contains the logic for interacting with the Groq API and generating SQL queries using a GPT-based model. It:

1. Initializes the Groq client with the API key.
2. Sends a prompt to the model, which includes the database schema and the query request.
3. Receives and processes the response from the model to generate a MySQL-compatible SQL query.


#### `database_utils.py`

This file contains functions to interact with the MySQL database, including:

1. **Connecting to MySQL**: Connects to the database using credentials.
2. **Fetching Database Schema**: Retrieves the schema information for the tables in the database.
3. **Executing SQL Queries**: Executes the SQL query generated by the model and returns the result.


## Environment Variables

- `GROQ_API_KEY`: Your Groq API key for accessing the LLM service

## Error Handling

The application includes error handling for:
- Database connection failures
- Schema retrieval errors
- Query generation failures
- Query execution errors

## Security Considerations

- Database credentials should be stored securely
- API keys should be managed through environment variables
- Input validation is recommended before query execution
- Connection closing is handled automatically

## Limitations

- Requires active internet connection for Groq API access
- Query generation accuracy depends on the LLM model
- Limited to MySQL syntax
- Schema retrieval may be slow for large databases


